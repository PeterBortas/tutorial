<!doctype html>
<html>
	<head>
	  <meta charset="utf-8">
	  <title>Magic Web Stuff</title>
	</head>
	<body>
	  <header>
      <div class="container">
        <h1>Pike Tutorial</h1>
      </div>
    </header>
    <section id="main">
      <div class="container"><h1>Magic Web Stuff</h1>
<p>Now it's time to start surfing the web! Perhaps you know that web pages are written in something called HTML (HyperText Markup Language), and that the <code>http</code> you see in web addresses like <code>http://pike.ida.liu.se/</code> means HyperText Transfer Protocol. The HyperText Transfer Protocol is a description of how web browsers communicate with web servers.</p>
<p>It is actually a fairly complicated operation to connect to a web server, to tell it to send you a web page, and then to receive that page as the server sends it. Fortunately for us, someone has already done this for us. There is a <strong>module</strong> called <code>Protocols.HTTP</code>, which handles the communication with the web server. A module is a package of Pike code that can easily be used by other programmers.</p>
<p>We rewrite the method <code>handle_url</code> to actually try to fetch the web page, using the module <code>Protocols.HTTP</code>:</p>
<pre><code class="language-pike">void handle_url(string this_url)
{
  write("Fetching URL '" + this_url + "'...");
  Protocols.HTTP.Query web_page;
  web_page = Protocols.HTTP.get_url(this_url);
  if (web_page == 0)
  {
    write(" Failed!\n");
    return;
  }
  write(" Done.\n");
} // handle_url</code></pre>
<p>The interesting part here is the lines</p>
<pre><code class="language-pike">  Protocols.HTTP.Query web_page;
  web_page = Protocols.HTTP.get_url(this_url);</code></pre>
<p>First we define the variable <code>web_page</code>, with the data type <code>Protocols.HTTP.Query</code>. Actually, the data type is called <code>Query</code>, and is defined in the module <code>Protocols.HTTP</code>, but we must write it as <code>Protocols.HTTP.Query</code> so Pike knows where to find it.</p>
<p>A data item of the type <code>Protocols.HTTP.Query</code> contains the result of a web page retrieval: the text of the web page, but also some more information, such as the time when the page was created.</p>
<p>The actual work is done by the method <code>Protocols.HTTP.get_url</code>, which is actually the method <code>get_url</code> in the module <code>Protocols.HTTP</code>. It talks to the web server, fills a <code>Query</code> object with everything it finds, and returns it. If it cannot find the web page, it returns zero (<strong>0</strong>) instead.</p>
<p>Some other things that might need to be explained in this example:</p>
<ul>
<li>We can use single quotes (') inside a string. If we want to put a double quote (&quot;) in a string, we can do so by prefixing the double quote with a backslash:
<pre><code class="language-pike">"This string contains a \"."</code></pre></li>
<li>If the web page couldn't be found, we use the statement
<pre><code class="language-pike">return;`</code></pre>
<p>to stop executing the method <code>handle_url</code>, and instead return to where it was called. This is the same as the</p>
<pre><code class="language-pike">return 0;</code></pre>
<p>we have seen in <code>main</code>, except that <code>handle_url</code> doesn't return a value.</p></li>
<li><code>return</code> just returns from the method we are in. If we want to terminate the program, we can use the built-in function <code>exit</code>:
<pre><code class="language-pike">exit(0);</code></pre>
<p>This has the same effect as returning <strong>0</strong> from <code>main</code>.</p></li>
</ul>
<p>When we run this version of the web browser, it may look something like this. The user's command is shown in <em>italics</em>:</p>
<pre><code>&gt; webbrowser.pike pike.ida.liu.se
Welcome to the Very Simple WWW Browser!
Fetching URL 'pike.lysator.liu.se'... Done.</code></pre>
<p>If we try to retrieve a web page that doesn't exist, the web browser fails:</p>
<pre><code>&gt; webbrowser.pike cod.lysator.liu.se
Welcome to the Very Simple WWW Browser!
Fetching URL 'cod.ida.liu.se'... Failed!</code></pre></div>
    </section>
    <footer>
      <div class="container">
        2015-04-05 15:34
      </div>
    </footer>
	</body>
</html>
